<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>jQuery UI Droppable - Shopping Cart Demo</title>
	<link rel="stylesheet" href="http://www.guimpo.com/css/cupertino/jquery-ui-1.8.9.custom.css?1">
	<script src="http://www.guimpo.com/js/jquery.js?1"></script>
	<script src="http://www.guimpo.com/js/jquery-ui-1.8.9.custom.min.js?1"></script>

	<link rel="stylesheet" href="../demos.css">
	<style>


	.demo{
		width:700px;
		height:auto;
		margin:0px auto;
		position:relative
	}
	
	#forms{
		width:200px;
		height:auto;
		float:left;
	}
	
	#forms div{
		width:200px;
		height:50px;
		line-height:50px;
		font-family:verdana;
		padding:5px;
		text-align:center;
		font-size:14px;
		font-weight:bold;
		display:block;
		float:left;
		border:1px #0070A3 solid;
		color:#0070A3;
		margin-bottom:5px;
		cursor:pointer;
		-webkit-border-radius: 10px; 
          -moz-border-radius: 10px; 
	}
	
	#cart { 
		width: 300px; 
		height:auto;
		min-height:200px;
		float: left; 
		margin:0px auto;
		text-align:center;
		float:right;
		padding:10px;
	}
	
	.drops{
	     position:relative;
	     left:44px;
		width:200px;
		height:50px;
		font-family:verdana;
		padding:5px;
		text-align:center;
		font-size:14px;
		font-weight:bold;
		border:1px #0070A3 solid;
		color:#0070A3;
		margin-bottom:5px;
		cursor:pointer;
		-webkit-border-radius: 10px; 
          -moz-border-radius: 10px; 		
	}
	
	.clear{
	     clear:both;
	}
	
	.optionsdrop{
	 display:inline;
	 font-size:11px;
	}

	
	</style>
	<script>
	
	var resultat = array();
	$(function() {

		$( "#forms div" ).draggable({
			helper: "clone"
		});
		
		$( "#cart" ).droppable({
			activeClass: "ui-state-default",
			hoverClass: "ui-state-hover",
			accept: ":not(.optionsdrop, .drops )",
			drop: function( event, ui ) {
				$( this ).find( ".placeholder" ).remove();
				
				var x =$( "<div class='drops'></div>" ).text( ui.draggable.text()  );
				var d = $( "<div class='optionsdrop'><br/><span>view</span> |<span>edit</span> | <span class='dropdelete'>delete</span></div>" ).appendTo(x);
				
				x.appendTo( this );
				
				var aux = $('#dialog-'+ui.draggable.text());
				
				aux.clone().appendTo('#choosen');
				
				
		$( "#choosen #dialog-"+ui.draggable.text() ).dialog({
			autoOpen: true,
			position: 'center',
			height: 550,
			width: 350,
			modal: true,
			buttons: {
				"Guardar": function() {
					$( this ).dialog( "close" );
					}
				}
		});

			}
		}).sortable({
			items: ":not(.optionsdrop, .optionsdrop span)",
			sort: function() {
				// gets added unintentionally by droppable interacting with sortable
				// using connectWithSortable fixes this, but doesn't allow you to customize active/hoverClass options
				$( this ).removeClass( "ui-state-default" );
			}
		});
	});
	
	
	
	  
      $(document).ready(function() {
   
         $('#enviar').click(function() {
           
           var x = recupera_dades();
           
         });

         
         $('.dropdelete').click(function() {
           
           alert('delete');
           
           $(this).parent().parent().parent().remove();
           
         });

      });
      
      
      function recupera_dades(){

        $('.tform:not(#templates .tform)').each(function(index) {

          if ($(this).hasClass('text')){
            
            tname  = $(this).find('.i_name').val();
            tclass   = $(this).find('.i_class').val();
            tvalue   = $(this).find('.i_value').val();
            tmandatory   = ($(this).find('.i_mandatory:checked').val() == '1') ? '1' : '0';
            ttype   = $(this).find('.i_type').val();
            tminlenght   = $(this).find('.i_minlenght').val();
            tmaxlenght   = $(this).find('.i_maxlenght').val();
            tsize   = $(this).find('.i_size').val();
            tdisabled   = ($(this).find('.i_disabled:checked').val() == '1') ? '1' : '0';
            treadonly   = ($(this).find('.i_readonly:checked').val() == '1') ? '1' : '0';
            ttabindex   = $(this).find('.i_tabindex').val();
            
            var json = "{\""+tname+"\":{\"class\":\""+tclass+"\", \"value\":\""+tvalue+"\", \"mandatory\":\""+tmandatory+"\", \"type\":\""+ttype+"\", \"minlength\":\""+tminlenght+"\", \"maxlength\":\""+tmaxlenght+"\", \"size\":\""+tsize+"\", \"disabled\":\""+tdisabled+"\", \"readonly\":\""+treadonly+"\", \"tabindex\":\""+ttabindex+"\"} }";
            
          }else if ($(this).hasClass('textarea')){
            
            tname  = $(this).find('.i_name').val();
            tclass   = $(this).find('.i_class').val();
            tvalue   = $(this).find('.i_value').val();
            tcols   = $(this).find('.i_cols').val();
            trows   = $(this).find('.i_rows').val();
            tmandatory   = ($(this).find('.i_mandatory:checked').val() == '1') ? '1' : '0';
            ttype   = $(this).find('.i_type').val();
            tminlenght   = $(this).find('.i_minlenght').val();
            tmaxlenght   = $(this).find('.i_maxlenght').val();
            tsize   = $(this).find('.i_size').val();
            tdisabled   = ($(this).find('.i_disabled:checked').val() == '1') ? '1' : '0';
            treadonly   = ($(this).find('.i_readonly:checked').val() == '1') ? '1' : '0';
            ttabindex   = $(this).find('.i_tabindex').val();
            
            var json = "{\""+tname+"\":{\"class\":\""+tclass+"\", \"value\":\""+tvalue+"\", \"mandatory\":\""+tmandatory+"\", \"cols\":\""+tcols+"\", \"rows\":\""+trows+"\", \"type\":\""+ttype+"\", \"minlength\":\""+tminlenght+"\", \"maxlength\":\""+tmaxlenght+"\", \"size\":\""+tsize+"\", \"disabled\":\""+tdisabled+"\", \"readonly\":\""+treadonly+"\", \"tabindex\":\""+ttabindex+"\"} }";
            alert(json);
          }else{
            
            alert('es nada');
            
          }
             
    
        }); 
        
      }


	</script>
</head>
<body>

<div class="demo">
	
	<div id='forms'>

		<div id='text' class='forms_items'>Text</div>
		<div id='textarea' class='forms_items'>Textarea</div>

	</div>

	
    <div id="cart" class="ui-widget-content">
    
      <span class="placeholder">AÃ±ade aqui los campos del formulario</span>

    </div>

    <div class='clear'></div>
    
    <br />
    
    <?php
    
      echo "<div class='options'>";
    
        echo "<b>BD</b><input type='checkbox' name='secuencia' id='secuencia'> <label for='secuencia'>Crear secuencia</label>";
        
        echo "&nbsp;&nbsp; <input type='checkbox' name='tabla' id='tabla'> <label for='tabla'>Crear tabla</label>";
        
        echo "&nbsp;&nbsp; <input type='checkbox' name='droptabla' id='droptabla'> <label for='droptabla'>Drop tabla</label>";
        
        echo "<br><br><input type='checkbox' name='htaccess' id='htaccess'><label for='htaccess'>Modificar htaccess</label>";
        
        //echo "&nbsp;&nbsp;<input type='checkbox' name='frontend' id='frontend'><label for='frontend'>Crear en frontend</label>";
    
        echo "&nbsp;&nbsp;<input type='checkbox' name='cambios' id='cambios'><label for='cambios'>Cambios en el codigo</label>";
        
        echo "&nbsp;&nbsp;<input type='checkbox' name='admin' id='admin'><label for='admin'>Crear en admin</label>";
      
      echo "</div>";
    
    ?>

<input type='button' id='enviar' value='Generar'>
    
</div><!-- End demo -->


<div id='templates' style='display:none'>
  
  <div id='dialog-Text' title='Nuevo form text' style='display:none;font-size:11px;'>
    <table class='text tform' cellpadding="2" cellspacing="5">
    
    	<tr>
    		<td width="80">Name</td><td><input type='text'  class="i_name" /></td>
    	</tr>

    	<tr>
    		<td width="80">Class</td><td><input type='text'  class="i_class"  /></td>
    	</tr>

    	<tr>
    		<td width="80">Value</td><td><input type='text'  class="i_value"  /></td>
    	</tr>

    	<tr>
    		<td width="80">Mandatory</td><td><input type='checkbox'  class="i_mandatory" value='1'> </td>
    	</tr>

    	<tr>
    		<td width="80">Type</td><td><input type='text'  class="i_type" value='text' readonly /></td>
    	</tr>

    	<tr>
    		<td width="80">Minlenght</td><td><input type='text'  class="i_minlenght"  size=4  value='1' /></td>
    	</tr>

    	<tr>
    		<td width="80">Maxlenght</td><td><input type='text'  class="i_maxlenght" size=4 value='60' /></td>
    	</tr>

    	<tr>
    		<td width="80">Size</td><td><input type='text'  class="i_size" size=4  value='60' /></td>
    	</tr>

    	<tr>
    		<td width="80">Disabled</td><td><input type='checkbox'  class="i_disabled" name='i_disabled' value='1' /></td>
    	</tr>

    	<tr>
    		<td width="80">Readonly</td><td><input type='checkbox'  class="i_readonly" name='i_readonly' value='1' /></td>
    	</tr>

    	<tr>
    		<td width="80">TabIndex</td><td><input type='text'  class="i_tabindex"  size=4  value='0' /></td>
    	</tr>

    </table>
  </div>
  
  <div id='dialog-Textarea' title='Nuevo form textarea' style='display:none; font-size:11px;''>
    <table class='textarea tform' cellpadding="2" cellspacing="5">
    
    	<tr>
    		<td width="80">Name</td><td><input type='text'  class="i_name" /></td>
    	</tr>

    	<tr>
    		<td width="80">Class</td><td><input type='text'  class="i_class"  /></td>
    	</tr>

    	<tr>
    		<td width="80">Value</td><td><input type='text'  class="i_value"  /></td>
    	</tr>

    	<tr>
    		<td width="80">Mandatory</td><td><input type='checkbox'  class="i_mandatory" value='1'> </td>
    	</tr>

    	<tr>
    		<td width="80">Columns</td><td><input type='text'  class="i_cols"  /> </td>
    	</tr>

    	<tr>
    		<td width="80">Rows</td><td><input type='text'  class="i_rows"  /> </td>
    	</tr>

    	<tr>
    		<td width="80">Type</td><td><input type='text'  class="i_type" value='text' readonly /></td>
    	</tr>

    	<tr>
    		<td width="80">Minlenght</td><td><input type='text'  class="i_minlenght"  size=4  value='1' /></td>
    	</tr>

    	<tr>
    		<td width="80">Maxlenght</td><td><input type='text'  class="i_maxlenght" size=4 value='60' /></td>
    	</tr>

    	<tr>
    		<td width="80">Size</td><td><input type='text'  class="i_size" size=4  value='60' /></td>
    	</tr>

    	<tr>
    		<td width="80">Disabled</td><td><input type='checkbox'  class="i_disabled" name='i_disabled' value='1' /></td>
    	</tr>

    	<tr>
    		<td width="80">Readonly</td><td><input type='checkbox'  class="i_readonly" name='i_readonly' value='1' /></td>
    	</tr>

    	<tr>
    		<td width="80">TabIndex</td><td><input type='text'  class="i_tabindex"  size=4  value='0' /></td>
    	</tr>

    </table>
  </div>
  

</div>


<div id='choosen'>

</div>




</body>
</html>
